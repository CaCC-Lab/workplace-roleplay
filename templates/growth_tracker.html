<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆé•·è¨˜éŒ² - è·å ´ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç·´ç¿’ã‚¢ãƒ—ãƒª</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f4f8;
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 10px;
            font-size: 28px;
        }
        .subtitle {
            color: #666;
            text-align: center;
            margin-bottom: 40px;
            font-size: 16px;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        .stat-card:nth-child(2) {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        .stat-card:nth-child(3) {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        .stat-card:nth-child(4) {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }
        .stat-value {
            font-size: 48px;
            font-weight: bold;
            margin: 10px 0;
        }
        .stat-label {
            font-size: 16px;
            opacity: 0.9;
        }
        .chart-container {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 40px;
            position: relative;
            height: 400px;
        }
        .chart-title {
            font-size: 20px;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }
        .skills-radar {
            max-width: 500px;
            margin: 0 auto;
        }
        .achievements-section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 40px;
        }
        .achievements-title {
            font-size: 24px;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 20px;
        }
        .achievement-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
            opacity: 0.3;
        }
        .achievement-card.earned {
            opacity: 1;
            border-color: #4CAF50;
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.2);
        }
        .achievement-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }
        .achievement-name {
            font-size: 14px;
            color: #333;
            font-weight: 500;
            margin-bottom: 5px;
        }
        .achievement-description {
            font-size: 12px;
            color: #666;
        }
        .recent-sessions {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 40px;
        }
        .sessions-title {
            font-size: 20px;
            color: #333;
            margin-bottom: 20px;
        }
        .session-item {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid #e9ecef;
        }
        .session-info {
            flex: 1;
        }
        .session-type {
            font-weight: 500;
            color: #333;
            margin-bottom: 5px;
        }
        .session-date {
            font-size: 14px;
            color: #666;
        }
        .session-score {
            font-size: 24px;
            font-weight: bold;
            color: #4CAF50;
        }
        .progress-bar-container {
            background: #e9ecef;
            border-radius: 10px;
            height: 20px;
            margin: 20px 0;
            overflow: hidden;
        }
        .progress-bar {
            background: linear-gradient(to right, #4CAF50, #8BC34A);
            height: 100%;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
            color: white;
            font-size: 12px;
            font-weight: bold;
        }
        .back-link {
            display: inline-block;
            margin-top: 20px;
            color: #007bff;
            text-decoration: none;
            font-size: 16px;
        }
        .back-link:hover {
            text-decoration: underline;
        }
        .no-data {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }
        .no-data-icon {
            font-size: 72px;
            margin-bottom: 20px;
            opacity: 0.3;
        }
        .no-data-text {
            font-size: 18px;
            margin-bottom: 10px;
        }
        .no-data-subtext {
            font-size: 14px;
            color: #999;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>æˆé•·è¨˜éŒ²</h1>
        <p class="subtitle">ã‚ãªãŸã®ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚­ãƒ«ã®æˆé•·ã‚’å¯è¦–åŒ–ã—ã¾ã™</p>

        <!-- çµ±è¨ˆã‚«ãƒ¼ãƒ‰ -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">ç·ç·´ç¿’å›æ•°</div>
                <div class="stat-value" id="totalPracticeCount">0</div>
                <div class="stat-label">å›</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">é€£ç¶šç·´ç¿’æ—¥æ•°</div>
                <div class="stat-value" id="streakDays">0</div>
                <div class="stat-label">æ—¥</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">å¹³å‡ã‚¹ã‚³ã‚¢</div>
                <div class="stat-value" id="averageScore">0</div>
                <div class="stat-label">%</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">ç²å¾—ãƒãƒƒã‚¸</div>
                <div class="stat-value" id="badgeCount">0</div>
                <div class="stat-label">å€‹</div>
            </div>
        </div>

        <!-- ã‚¹ã‚­ãƒ«ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ -->
        <div class="chart-container">
            <div class="chart-title">ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚­ãƒ«åˆ†æ</div>
            <div class="skills-radar">
                <canvas id="skillsRadarChart"></canvas>
            </div>
        </div>

        <!-- é€²æ—ã‚°ãƒ©ãƒ• -->
        <div class="chart-container">
            <div class="chart-title">ç·´ç¿’ã‚¹ã‚³ã‚¢ã®æ¨ç§»</div>
            <canvas id="progressChart"></canvas>
        </div>

        <!-- ã‚¢ãƒãƒ¼ãƒ–ãƒ¡ãƒ³ãƒˆ -->
        <div class="achievements-section">
            <h2 class="achievements-title">ç²å¾—ãƒãƒƒã‚¸</h2>
            <div class="achievements-grid" id="achievementsGrid">
                <!-- ãƒãƒƒã‚¸ãŒã“ã“ã«å‹•çš„ã«è¿½åŠ ã•ã‚Œã¾ã™ -->
            </div>
        </div>

        <!-- æœ€è¿‘ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ -->
        <div class="recent-sessions">
            <h3 class="sessions-title">æœ€è¿‘ã®ç·´ç¿’è¨˜éŒ²</h3>
            <div id="recentSessionsList">
                <div class="no-data">
                    <div class="no-data-icon">ğŸ“Š</div>
                    <div class="no-data-text">ã¾ã ç·´ç¿’è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“</div>
                    <div class="no-data-subtext">ç·´ç¿’ã‚’å§‹ã‚ã¦ã€ã‚ãªãŸã®æˆé•·ã‚’è¨˜éŒ²ã—ã¾ã—ã‚‡ã†</div>
                </div>
            </div>
        </div>

        <a href="/" class="back-link">â† ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</a>
    </div>

    <script>
        // ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã¨ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ç®¡ç†
        let practiceData = JSON.parse(localStorage.getItem('practiceData')) || {
            totalCount: 0,
            streakDays: 0,
            sessions: [],
            achievements: [],
            skills: {
                empathy: 0,
                clarity: 0,
                listening: 0,
                confidence: 0,
                flexibility: 0
            }
        };

        // ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆï¼ˆå®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆï¼‰
        if (practiceData.sessions.length === 0) {
            practiceData = generateSampleData();
            localStorage.setItem('practiceData', JSON.stringify(practiceData));
        }

        // ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆé–¢æ•°
        function generateSampleData() {
            const sessions = [];
            const today = new Date();
            
            // éå»30æ—¥åˆ†ã®ã‚µãƒ³ãƒ—ãƒ«ã‚»ãƒƒã‚·ãƒ§ãƒ³
            for (let i = 29; i >= 0; i -= Math.floor(Math.random() * 3) + 1) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                
                sessions.push({
                    date: date.toISOString(),
                    type: ['ã‚·ãƒŠãƒªã‚ªç·´ç¿’', 'é›‘è«‡ç·´ç¿’', 'è¦³æˆ¦ãƒ¢ãƒ¼ãƒ‰'][Math.floor(Math.random() * 3)],
                    score: Math.floor(Math.random() * 30) + 70,
                    skills: {
                        empathy: Math.floor(Math.random() * 30) + 70,
                        clarity: Math.floor(Math.random() * 30) + 70,
                        listening: Math.floor(Math.random() * 30) + 70,
                        confidence: Math.floor(Math.random() * 30) + 70,
                        flexibility: Math.floor(Math.random() * 30) + 70
                    }
                });
            }
            
            return {
                totalCount: sessions.length,
                streakDays: 3,
                sessions: sessions,
                achievements: ['first_step', 'week_champion', 'empathy_master'],
                skills: {
                    empathy: 85,
                    clarity: 78,
                    listening: 82,
                    confidence: 75,
                    flexibility: 80
                }
            };
        }

        // ã‚¢ãƒãƒ¼ãƒ–ãƒ¡ãƒ³ãƒˆã®å®šç¾©
        const achievements = [
            { id: 'first_step', name: 'åˆã‚ã¦ã®ä¸€æ­©', icon: 'ğŸ¯', description: 'åˆå›ç·´ç¿’å®Œäº†' },
            { id: 'week_champion', name: 'é€±é–“ãƒãƒ£ãƒ³ãƒ”ã‚ªãƒ³', icon: 'â­', description: '7æ—¥é€£ç¶šç·´ç¿’' },
            { id: 'practice_10', name: 'ç·´ç¿’ã®ç¿’æ…£åŒ–', icon: 'ğŸ“š', description: '10å›ç·´ç¿’å®Œäº†' },
            { id: 'empathy_master', name: 'å…±æ„ŸåŠ›ã®å‘ä¸Š', icon: 'ğŸ’', description: 'å…±æ„ŸåŠ›80%ä»¥ä¸Š' },
            { id: 'clear_speaker', name: 'æ˜ç¢ºãªä¼é”è€…', icon: 'ğŸ’¬', description: 'æ˜ç¢ºæ€§80%ä»¥ä¸Š' },
            { id: 'good_listener', name: 'å„ªã‚ŒãŸèãæ‰‹', icon: 'ğŸ‘‚', description: 'å‚¾è´åŠ›80%ä»¥ä¸Š' },
            { id: 'confident', name: 'è‡ªä¿¡ã«æº€ã¡ãŸè©±è€…', icon: 'ğŸ’ª', description: 'è‡ªä¿¡åº¦80%ä»¥ä¸Š' },
            { id: 'flexible', name: 'æŸ”è»Ÿãªå¯¾å¿œè€…', icon: 'ğŸ”„', description: 'æŸ”è»Ÿæ€§80%ä»¥ä¸Š' },
            { id: 'practice_master', name: 'ãƒã‚¹ã‚¿ãƒ¼', icon: 'ğŸ†', description: '50å›ç·´ç¿’å®Œäº†' }
        ];

        // çµ±è¨ˆæƒ…å ±ã®è¡¨ç¤º
        function displayStats() {
            document.getElementById('totalPracticeCount').textContent = practiceData.totalCount;
            document.getElementById('streakDays').textContent = practiceData.streakDays;
            
            const avgScore = practiceData.sessions.length > 0 
                ? Math.round(practiceData.sessions.reduce((sum, s) => sum + s.score, 0) / practiceData.sessions.length)
                : 0;
            document.getElementById('averageScore').textContent = avgScore;
            document.getElementById('badgeCount').textContent = practiceData.achievements.length;
        }

        // ã‚¹ã‚­ãƒ«ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã®ä½œæˆ
        function createSkillsRadarChart() {
            const ctx = document.getElementById('skillsRadarChart').getContext('2d');
            new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['å…±æ„ŸåŠ›', 'æ˜ç¢ºæ€§', 'å‚¾è´åŠ›', 'è‡ªä¿¡', 'æŸ”è»Ÿæ€§'],
                    datasets: [{
                        label: 'ç¾åœ¨ã®ã‚¹ã‚­ãƒ«',
                        data: [
                            practiceData.skills.empathy,
                            practiceData.skills.clarity,
                            practiceData.skills.listening,
                            practiceData.skills.confidence,
                            practiceData.skills.flexibility
                        ],
                        backgroundColor: 'rgba(76, 175, 80, 0.2)',
                        borderColor: 'rgba(76, 175, 80, 1)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgba(76, 175, 80, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(76, 175, 80, 1)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                stepSize: 20
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // é€²æ—ã‚°ãƒ©ãƒ•ã®ä½œæˆ
        function createProgressChart() {
            const ctx = document.getElementById('progressChart').getContext('2d');
            
            // æœ€æ–°ã®10ã‚»ãƒƒã‚·ãƒ§ãƒ³
            const recentSessions = practiceData.sessions.slice(-10);
            const labels = recentSessions.map(s => {
                const date = new Date(s.date);
                return `${date.getMonth() + 1}/${date.getDate()}`;
            });
            const scores = recentSessions.map(s => s.score);
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'ã‚¹ã‚³ã‚¢',
                        data: scores,
                        backgroundColor: 'rgba(33, 150, 243, 0.1)',
                        borderColor: 'rgba(33, 150, 243, 1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 5,
                        pointBackgroundColor: 'rgba(33, 150, 243, 1)',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointHoverRadius: 7
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return 'ã‚¹ã‚³ã‚¢: ' + context.parsed.y + '%';
                                }
                            }
                        }
                    }
                }
            });
        }

        // ã‚¢ãƒãƒ¼ãƒ–ãƒ¡ãƒ³ãƒˆã®è¡¨ç¤º
        function displayAchievements() {
            const grid = document.getElementById('achievementsGrid');
            grid.innerHTML = '';
            
            achievements.forEach(achievement => {
                const card = document.createElement('div');
                card.className = 'achievement-card';
                if (practiceData.achievements.includes(achievement.id)) {
                    card.classList.add('earned');
                }
                
                card.innerHTML = `
                    <div class="achievement-icon">${achievement.icon}</div>
                    <div class="achievement-name">${achievement.name}</div>
                    <div class="achievement-description">${achievement.description}</div>
                `;
                
                grid.appendChild(card);
            });
        }

        // æœ€è¿‘ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®è¡¨ç¤º
        function displayRecentSessions() {
            const list = document.getElementById('recentSessionsList');
            
            if (practiceData.sessions.length === 0) {
                return;
            }
            
            list.innerHTML = '';
            const recentSessions = practiceData.sessions.slice(-5).reverse();
            
            recentSessions.forEach(session => {
                const sessionDate = new Date(session.date);
                const item = document.createElement('div');
                item.className = 'session-item';
                
                item.innerHTML = `
                    <div class="session-info">
                        <div class="session-type">${session.type}</div>
                        <div class="session-date">${sessionDate.toLocaleDateString('ja-JP')} ${sessionDate.toLocaleTimeString('ja-JP', { hour: '2-digit', minute: '2-digit' })}</div>
                    </div>
                    <div class="session-score">${session.score}%</div>
                `;
                
                list.appendChild(item);
            });
        }

        // åˆæœŸåŒ–
        function init() {
            displayStats();
            createSkillsRadarChart();
            createProgressChart();
            displayAchievements();
            displayRecentSessions();
        }

        // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã«å®Ÿè¡Œ
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>