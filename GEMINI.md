# GEMINI.md: プロジェクト概要

このドキュメントは、AIエージェントが `workplace-roleplay` プロジェクトを理解するために生成した概要です。

## 1. プロジェクトの目的

**AI職場コミュニケーショントレーナー**

このプロジェクトは、AIとの対話を通じて、職場のコミュニケーションスキルを安全な環境で練習し、向上させることを目的としたWebアプリケーションです。単に会話スキルを訓練するだけでなく、ユーザーの**強みを分析・可視化**し、**自己肯定感を高める**ことにも重点を置いています。

## 2. 主要機能

このアプリケーションは、主に以下の4つの機能で構成されています。

1.  **シナリオロールプレイ**:
    *   `scenarios/data/` にあるYAMLファイルで定義された、30以上の具体的な職場シチュエーション（例：上司への報告、依頼の断り方）をAI相手に練習できます。
    *   会話後には、AIから客観的で具体的なフィードバックが提供されます。

2.  **雑談練習モード**:
    *   同僚や上司など、相手の立場を設定し、フリーテーマで日常的な会話スキルを磨くことができます。

3.  **会話観戦モード**:
    *   2体のAI同士が特定のテーマで会話する様子を観察し、会話の運び方や話題の広げ方を客観的に学習できます。

4.  **強み分析システム**:
    *   ユーザーの会話内容を分析し、「共感力」「明確な伝達力」「傾聴力」など6つのスキル項目を評価します。
    *   結果はレーダーチャートで可視化され、ユーザーは自身の長所を客観的に把握できます。

## 3. 技術スタック

このプロジェクトは、以下の技術要素で構築されています。

-   **バックエンド**:
    -   **フレームワーク**: Flask (Python)
    -   **AI連携**: LangChain
    -   **セッション管理**: Flask-Session (ファイルシステム or Redis)
    -   **シナリオ定義**: PyYAML

-   **フロントエンド**:
    -   **言語**: JavaScript (フレームワーク非依存)
    -   **リアルタイム通信**: Server-Sent Events (SSE)
    -   **グラフ描画**: Chart.js

-   **AIモデル**:
    -   **対話**: Google Gemini 1.5 Pro / Flash
    -   **音声合成 (TTS)**: Google Gemini TTS API (30種類以上の音声に対応)

## 4. アーキテクチャと特徴

-   **リアルタイム性**: Server-Sent Events (SSE) を利用し、AIの応答を低遅延でクライアントにストリーミングしています。
-   **柔軟なシナリオ管理**: 新しいロールプレイシナリオをYAMLファイルとして追加するだけで、簡単に拡張できます。
-   **高度な音声体験**:
    -   シナリオの役柄（性別、役職）に応じて、30種類以上の音声から最適なものが自動で割り当てられます。
    -   音声データはAIの応答生成と並行して非同期に生成・キャッシュされ、ユーザーは待つことなくスムーズに音声を再生できます。
-   **APIキー管理**: `api_key_manager.py` により、複数のAPIキーをローテーションさせ、レート制限のリスクを軽減しています。

## 5. プロジェクト構造

主要なファイルとディレクトリの役割は以下の通りです。

-   `app.py`: Flaskアプリケーションのメインファイル。ルーティング、APIエンドポイント、セッション管理などを担当。
-   `strength_analyzer.py`: 会話履歴を分析し、6つの強みスコアを算出するロジック。
-   `api_key_manager.py`: Google APIキーの管理とローテーションを行う。
-   `scenarios/data/`: 各ロールプレイシナリオを定義したYAMLファイル群。
-   `static/js/`: 各ページ（`chat.js`, `scenario.js`など）のフロントエンドロジック。
-   `static/css/`: スタイルシート。
-   `templates/`: 各ページのHTMLテンプレート。
