<!DOCTYPE html>
<html>
<head>
    <title>シナリオ表示テスト</title>
</head>
<body>
    <h1>シナリオ表示デバッグ</h1>
    <div id="results"></div>
    
    <script>
        const resultsDiv = document.getElementById('results');
        
        function log(message, isError = false) {
            const p = document.createElement('p');
            p.textContent = message;
            if (isError) p.style.color = 'red';
            resultsDiv.appendChild(p);
            console.log(message);
        }
        
        async function debugScenarioDisplay() {
            log('デバッグ開始...');
            
            try {
                // ページを取得
                const response = await fetch('http://localhost:5001/scenarios');
                const html = await response.text();
                
                // HTMLをパース
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                
                // シナリオカードを確認
                const cards = doc.querySelectorAll('.scenario-card');
                log(`HTMLに含まれるシナリオカード数: ${cards.length}`);
                
                // カードの初期スタイルを確認
                let visibleCount = 0;
                let hiddenCount = 0;
                
                cards.forEach((card, index) => {
                    const style = card.getAttribute('style');
                    if (style && style.includes('display: none')) {
                        hiddenCount++;
                    } else {
                        visibleCount++;
                    }
                    
                    if (index < 3) {  // 最初の3つだけログ
                        log(`カード${index + 1}のstyle属性: ${style || 'なし'}`);
                    }
                });
                
                log(`表示されているカード: ${visibleCount}`);
                log(`非表示のカード: ${hiddenCount}`);
                
                // JavaScriptエラーをチェック
                const scriptTags = doc.querySelectorAll('script');
                log(`\nスクリプトタグ数: ${scriptTags.length}`);
                
                // scenarios_list.jsが読み込まれているか確認
                const hasScenarioScript = Array.from(scriptTags).some(script => 
                    script.src && script.src.includes('scenarios_list.js')
                );
                log(`scenarios_list.jsの読み込み: ${hasScenarioScript ? 'あり' : 'なし'}`);
                
            } catch (error) {
                log(`エラー: ${error.message}`, true);
            }
        }
        
        // デバッグを実行
        debugScenarioDisplay();
    </script>
</body>
</html>